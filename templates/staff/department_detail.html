{% extends 'staff/main_staff.html' %}

{% block title %}{{ department.name }} - Staff Organization{% endblock %}

{% block staff_content %}
<div class="row">
    <div class="col-12">
        <div class="card mb-4">
            <div class="card-header bg-primary text-white">
                <h3 class="card-title mb-0">{{ department.name }}</h3>
            </div>
            <div class="card-body">
                {% if department.manager %}
                    <p><strong>Руководитель:</strong> 
                       <a href="{{ department.manager.get_absolute_url }}">
                           {{ department.manager.full_name }}
                       </a>
                    </p>
                {% endif %}
                
                {% if department.parent_department %}
                    <p><strong>Родительское подразделение:</strong> 
                       <a href="{{ department.parent_department.get_absolute_url }}">
                           {{ department.parent_department.name }}
                       </a>
                    </p>
                {% endif %}
            </div>
        </div>

        {% if employees %}
        <div class="card mb-4">
            <div class="card-header bg-secondary text-white">
                <h5 class="card-title mb-0">Сотрудники ({{ employees.count }})</h5>
            </div>
            <div class="card-body">
                {% for employee in employees %}
                    <div class="employee-card" onclick="location.href='{{ employee.get_absolute_url }}'">
                        <strong>{{ employee.full_name }}</strong> - {{ employee.position }}
                        {% if employee.phone %}
                            <br><small>{{ employee.phone }}</small>
                        {% endif %}
                    </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}

        {% if child_departments %}
        <div class="card">
            <div class="card-header bg-info text-white">
                <h5 class="card-title mb-0">Дочерние подразделения</h5>
            </div>
            <div class="card-body">
                {% for child in child_departments %}
                    <div class="department-card" onclick="location.href='{{ child.get_absolute_url }}'">
                        <h6>{{ child.name }}</h6>
                        {% if child.manager %}
                            <small class="text-muted">Руководитель: {{ child.manager.full_name }}</small>
                        {% endif %}
                    </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}

        <div class="mt-3">
            <a href="{% url 'staff:structure' %}" class="btn btn-outline-primary">
                ← Назад к структуре
            </a>
        </div>
    </div>
</div>
{% endblock %}