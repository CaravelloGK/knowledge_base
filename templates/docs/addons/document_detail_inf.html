{% extends 'index.html' %}
{% load static %}

{% block extra_head %}
<link rel="stylesheet" href="{% static 'docs/css/main.css' %}">
{% endblock %}

{% block content %}
<div class="container my-5 detail-page">
  <header style="z-index: 1 !important;" class="mb-4">
    <h1 class="display-6 fw-bold">{{ document.title }}</h1>
  </header>

  <!-- Карточка документа -->
  <div class="card shadow-sm position-relative" style="background-color: #fff;">
    <!-- Блок иконок (админские кнопки) -->
    <div class="action-icons position-absolute top-0 end-0 m-3 d-flex align-items-center gap-3">
      <a href="{% url 'docs:document_update' pk=document.id %}" class="action-link" title="Редактировать">
        <img src="{% static 'img/edit.svg' %}" alt="Редактировать" class="action-icon">
      </a>
      <a href="#" data-bs-toggle="modal" data-bs-target="#deleteModal" class="action-link" title="Удалить">
        <img src="{% static 'img/delete.svg' %}" alt="Удалить" class="action-icon">
      </a>
      {% if document.global_section.name == 'Корпоративный бизнес' %}
        <a href="{% url 'docs:kb_home' %}" class="action-link" title="Закрыть">
          <img src="{% static 'img/close.svg' %}" alt="Закрыть" class="action-icon">
        </a>
      {% elif document.global_section.name == 'Розничный бизнес' %}
        <a href="{% url 'docs:rb_home' %}" class="action-link" title="Закрыть">
          <img src="{% static 'img/close.svg' %}" alt="Закрыть" class="action-icon">
        </a>
      {% elif document.global_section.name == 'Административно-хозяйственная деятельность' %}
        <a href="{% url 'docs:ahd_home' %}" class="action-link" title="Закрыть">
          <img src="{% static 'img/close.svg' %}" alt="Закрыть" class="action-icon">
        </a>
      {% elif document.global_section.name == 'Инвестиционный и международный бизнес' %}
        <a href="{% url 'docs:mb_home' %}" class="action-link" title="Закрыть">
          <img src="{% static 'img/close.svg' %}" alt="Закрыть" class="action-icon">
        </a>
      {% elif document.global_section.name == 'Корп. управление и раскрытие информации' %}
        <a href="{% url 'docs:kuri_home' %}" class="action-link" title="Закрыть">
          <img src="{% static 'img/close.svg' %}" alt="Закрыть" class="action-icon">
        </a>
      {% else %}
        <a href="{% url 'docs:kb_home' %}" class="action-link" title="Закрыть">
          <img src="{% static 'img/close.svg' %}" alt="Закрыть" class="action-icon">
        </a>
      {% endif %}
    </div>

    <!-- Содержимое карточки -->
    <div class="card-body">
      <!-- Верхняя строка: рубрики, дата создания и категория -->
      <div class="status-line mb-4">
        <small class="text-muted">
          <span class="created-date">{{ document.created_at|date:"d.m.Y" }}</span>
          <span class="status-divider mx-1">|</span>
          <span class="global-section">{{ document.global_section }}</span>
          {% if document.category %}
          <span class="status-divider mx-1">|</span>
          <span class="category">{{ document.category }}</span>
          {% endif %}
        </small>
      </div>

      <p class="card-text mb-4">{{ document.description|safe }}</p>
    </div>

    <!-- Нижняя строка: информация о документе -->
    <div class="card-footer bg-white border-0 d-flex align-items-center gap-3 pb-3">
      <p class="text-muted small mb-0">
        <strong>Тип документа:</strong> {{ document.subcategory }}
      </p>
      {% if document.is_template %}
      <span class="badge bg-primary">Шаблон</span>
      {% endif %}
    </div>
  </div>
</div>

<!-- Модальное окно удаления -->
<div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="deleteModalLabel">Подтверждение удаления</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Закрыть"></button>
      </div>
      <div class="modal-body">
        Вы уверены, что хотите удалить документ "{{ document.title }}"?
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Отмена</button>
        <a href="{% url 'docs:document_delete' pk=document.id %}" class="btn btn-danger">Удалить</a>
      </div>
    </div>
  </div>
</div>
{% endblock %}