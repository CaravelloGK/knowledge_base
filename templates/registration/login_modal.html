{% extends "index.html" %}

{% block modal %}
<div class="modal fade show" id="loginModal" tabindex="-1" aria-hidden="false" style="display: block; padding-right: 15px;">
  <div class="modal-dialog">
    <div class="modal-content">
      <form method="post" action="{% url 'login' %}">
        {% csrf_token %}
        <input type="hidden" name="next" value="{{ request.GET.next }}">
        
        <div class="modal-header">
          <h5 class="modal-title">Вход в систему</h5>
          <button type="button" class="btn-close" onclick="closeModal()"></button>
        </div>
        
        <div class="modal-body">
          {% if form.errors %}
            <div class="alert alert-danger">Неверное имя пользователя или пароль</div>
          {% endif %}
          
          <div class="mb-3">
            <label for="id_username" class="form-label">Логин</label>
            <input type="text" name="username" class="form-control" required id="id_username">
          </div>
          
          <div class="mb-3">
            <label for="id_password" class="form-label">Пароль</label>
            <input type="password" name="password" class="form-control" required id="id_password">
          </div>
        </div>
        
        <div class="modal-footer">
          <button type="submit" class="btn btn-primary">Войти</button>
          <button type="button" class="btn btn-secondary" onclick="closeModal()">Отмена</button>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
function closeModal() {
    window.location.href = "{{ request.GET.next|default:'/' }}";
}
</script>
{% endblock %}